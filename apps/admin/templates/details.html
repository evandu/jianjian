<div class="row">
    <div class="col-xs-12">
        <div class="box box-primary">
            <div class="box-header with-border">
                <h3 class="box-title">订单编号:{{order.OrderNo}}详细</h3>
            </div><!-- /.box-header -->
            <form class="form-horizontal" >
                <div class="box-body">
                    <div class="form-group" >
                        <label class="col-sm-2 control-label">姓名：</label>
                        <div class="col-sm-4"> {{order.Name}}</div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">手机：</label>
                        <div class="col-sm-4">{{order.Mobile}} </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">基本信息：</label>
                        <div class="col-sm-4">{{gender order.Gender}} {{order.Age}}岁 {{order.Height}}cm  {{order.Weight}} kg  {{order.BornDate}}</div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">地址：</label>
                        <div class="col-sm-4">
                            {{order.Area}}  {{order.Address}}
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">邮箱：</label>
                        <div class="col-sm-4">
                            {{order.Email}}
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">体检码：</label>
                        <div class="col-sm-4">
                                {{order.PromoteCode}}
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">优惠金额：</label>
                        <div class="col-sm-4">
                            {{amount order.PromotePrice}} 元
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">服务费：</label>
                        <div class="col-sm-4">
                            <!-- 服务费： --> {{amount order.ServicePrice}}  元
                            <!-- 押金: {{amount order.Deposit}} -->
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">当前状态：</label>
                        <div class="col-sm-4">
                            {{OrderStatus order.Status}}
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">物流公司：</label>
                        <div class="col-sm-4">
                            {{order.DeliverName}}
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">使用时间：</label>
                        <div class="col-sm-4">
                            {{YYYY年MM月DD日  order.UseDate}}
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">物流单号：</label>
                        <div class="col-sm-4">
                            {{order.DeliverNum}}
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">配送时间：</label>
                        <div class="col-sm-4">
                            {{yyy-MM-ddHHmmss  order.DeliverDate}}
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">设备编号：</label>
                        <div class="col-sm-4">
                            {{order.DeviceNumber}}
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">耗材编号：</label>
                        <div class="col-sm-4">
                            {{order.MaterialNumber }}
                        </div>
                    </div>

                    <!--
                    <div class="form-group" >
                        <label class="col-sm-2 control-label">押金退款状态：</label>
                        <div class="col-sm-4">
                            {{RefundDepositStatus order.RefundDepositStatus}}
                        </div>
                    </div>


                    <div class="form-group" >
                        <label class="col-sm-2 control-label">押金退款时间：</label>
                        <div class="col-sm-4">
                            {{yyy-MM-ddHHmmss order.RefundDepositDate}}
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">押金退款金额：</label>
                        <div class="col-sm-4">
                            {{amount order.RefundDeposit}}
                        </div>
                    </div>
                     -->

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">创建时间：</label>
                        <div class="col-sm-4">
                             {{yyy-MM-ddHHmmss order.CreateDate}}
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-sm-2 control-label">最后一次更新时间：</label>
                        <div class="col-sm-3">
                            {{ yyy-MM-ddHHmmss order.LastUpdateDate}}
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"></label>
                        <div class="col-sm-4">

                            {{#compare order.Status '==' '1'}}
                                <button type="button" status ={{order.Status}}
                                        class="btn  btn-primary pull-left" data-toggle="modal" data-target="#status2Dialog" >
                                    <i class="fa  fa-hand-grab-o"></i> {{nextStatus order.Status}}
                                </button>
                            {{/compare}}

                          <!--  {{#compare order.Status '==' '3'}}
                                <button type="button" status ={{order.Status}}
                                        class="btn  btn-primary pull-left" data-toggle="modal" data-target="#status4Dialog" >
                                    <i class="fa  fa-hand-grab-o"></i> {{nextStatus order.Status}}
                                </button>
                            {{/compare}} -->

                            {{#compare order.Status 'in' '2,3,4,5'}}
                               <button type="button" status ={{order.Status}}
                                    class="btn  btn-success pull-left" >
                                   <i class="fa  fa-hand-grab-o"></i> {{nextStatus order.Status}}
                               </button>
                            {{/compare}}

                            {{#compare order.Status '==' '6'}}
                              <a href="upload/{{order.OrderNo}}">
                                  <button type="button" class="btn  btn-primary pull-left">
                                      <i class="fa fa-upload "></i> {{nextStatus order.Status}}
                                  </button>
                              </a>
                            {{/compare}}

                            {{#compare order.Status '==' '7'}}
                            <a href="upload/{{order.OrderNo}}">
                                <button type="button"  class="btn btn-primary pull-left">
                                    <i class="fa fa-edit"></i> 修改报告结果
                                </button>
                            </a>
                            {{/compare}}

                            {{#compare order.Status 'in' '-1,0'}}
                                 <button type="button" class="btn btn-danger pull-left" data-toggle="modal" data-target="#msgDialog">
                                     <i class="fa fa-remove "></i> 取消订单
                                 </button>
                            {{/compare}}
                        </div>
                        <div class="col-sm-2">
                            <button type="button"
                                    class="btn  btn-warning pull-right" data-toggle="modal" data-target="#statusRandomDialog" >
                                <i class="fa  fa-edit"></i> 修改订单状态
                            </button>
                        </div>
                    </div>
                </div><!-- /.box-body -->
            </form>
        </div><!-- /.box -->
    </div><!-- /.col -->
</div><!-- /.row -->

<div class="modal fade" id="msgDialog" role="dialog" aria-labelledby="MsgDialogLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span></button>
                <h4 class="modal-title">确认取消</h4>
            </div>
            <div class="modal-body">
                <p>你确定取消该订单吗？，取消后无法还原订单</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default pull-left" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-danger btn-cancel">确定取消</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>


<div class="modal fade" id="status2Dialog" role="dialog" aria-labelledby="status2DialogLabel" aria-hidden="true">
    <form class="form-horizontal" method="post" action="update2Status">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span></button>
                <h4 class="modal-title">设备已寄出</h4>
            </div>
              <div class="modal-body">
                    <input  name="OrderNo"  type="hidden" value="{{order.OrderNo}}"/>
                    <div class="form-group" >
                        <label class="col-sm-4 control-label">物流公司：</label>
                        <div class="col-sm-6">
                            <input  name="DeliverName" value="{{order.DeliverName}}" type="text" class="form-control"  placeholder="物流公司"/>
                        </div>
                    </div>
                    <div class="form-group" >
                        <label class="col-sm-4 control-label">物流单号：</label>
                        <div class="col-sm-6">
                            <input  name="DeliverNum" value="{{order.DeliverNum}}" type="text" class="form-control"  placeholder="物流单号"/>
                        </div>
                    </div>
                  <div class="form-group" >
                      <label class="col-sm-4 control-label">设备编号：</label>
                      <div class="col-sm-6">
                          <input  name="DeviceNumber" value="{{order.DeviceNumber}}" type="text" class="form-control"  placeholder="设备编号"/>
                      </div>
                  </div>
                  <div class="form-group" >
                      <label class="col-sm-4 control-label">耗材编号：</label>
                      <div class="col-sm-6">
                          <input  name="MaterialNumber" value="{{order.MaterialNumber}}" type="text" class="form-control"  placeholder="耗材编号"/>
                      </div>
                  </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default pull-left" data-dismiss="modal">关闭</button>
                <button type="submit" class="btn btn-danger">设备已寄出</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
    </form>
</div>


<div class="modal fade" id="status4Dialog" role="dialog" aria-labelledby="status4DialogLabel" aria-hidden="true">
    <form class="form-horizontal"  method="post" action="update4Status" >
        <input  name="OrderNo"  type="hidden" value="{{order.OrderNo}}"/>
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span></button>
                <h4 class="modal-title">押金退还</h4>
            </div>
            <div class="modal-body">
                    <div class="form-group" >
                        <label class="col-sm-4 control-label">押金退款：</label>
                        <div class="col-sm-4">
                            <div class="form-group col-sm-12 ">
                                <select class="form-control" name="RefundDepositStatus">
                                    <option value="0" {{#compare order.RefundDepositStatus '==' '0'}}  selected {{/compare}}>无需退款</option>
                                    <option value="1" {{#compare order.RefundDepositStatus  '==' '1'}} selected {{/compare}}>已退款</option>
                                    <option value="2" {{#compare order.RefundDepositStatus  '==' '2'}} selected {{/compare}}>未退款</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" >
                        <label class="col-sm-4 control-label">押金退款金额：</label>
                        <div class="col-sm-6">
                            <input  name="RefundDeposit"  value= "{{amount order.PayDepositAmount}}" type="text" class="form-control"  placeholder="押金退款金额"/>
                        </div>
                    </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default pull-left" data-dismiss="modal">关闭</button>
                <button type="submit" class="btn btn-danger">押金退款</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
    </form>
</div>



<div class="modal fade" id="statusRandomDialog" role="dialog" aria-labelledby="statusRandomDialogLabel" aria-hidden="true">
    <form class="form-horizontal"  method="post" action="updateRandomStatus" >
        <input  name="OrderNo"  type="hidden" value="{{order.OrderNo}}"/>
        <input  name="Status"  type="hidden" value="{{order.Status}}"/>
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span></button>
                    <h4 class="modal-title">修改订单状态</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group" >
                        <label class="col-sm-4 control-label">修改订单状态：</label>
                        <div class="col-sm-4">
                            <div class="form-group col-sm-12 ">
                                <select class="form-control" name="randomStatus">
                                    {{#orderStatusList}}
                                    <option value="{{0}}">{{1}}</option>
                                    {{/orderStatusList}}
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">关闭</button>
                    <button type="submit" class="btn btn-danger">确认修改订单状态</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </form>
</div>



<script>
    $(function ($) {
        function refresh() {
            window.location.href=window.location.href;
        }

        $(".btn-success").click(function (e) {
            $.ajax({
                type: "post",
                url: "orderStatusNext",
                data: {OrderNo:'{{order.OrderNo}}',Status:'{{order.Status}}'},
                dataType: 'json'
            }).success(function (items) {
                refresh();
            }).fail(function () {
                alert("更新失败")
                refresh();
            })
        })

        $(".btn-cancel").click(function (e) {
            $('#msgDialog').modal('hide');
            $.ajax({
                type: "post",
                url: "orderCancel",
                data: {OrderNo:'{{order.OrderNo}}',Status:'{{order.Status}}'},
                dataType: 'json'
            }).success(function (items) {
                refresh();
            }).fail(function () {
                alert("取消失败")
                refresh();
            })
        })
    })

</script>